<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>The Uncanny Blooms of Kyoto â€” Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <!-- MarkerCluster CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />

  <style>
    html, body { margin: 0; padding: 0; height: 100%; }
    #map { width: 100%; height: 100vh; }
    /* Muted pink accent cluster bubbles */
    .marker-cluster-small { background: rgba(255,105,180,0.35); color:#fff; }
    .marker-cluster-medium { background: rgba(255,105,180,0.55); color:#fff; }
    .marker-cluster-large { background: rgba(255,105,180,0.75); color:#fff; }
    .marker-cluster div { border: 2px solid rgba(255,105,180,0.8); }
    /* Popup image styling */
    .popup-img { max-width: 200px; border-radius: 8px; margin-top: 5px; }
  </style>
</head>
<body>
  <div id="map"></div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <!-- MarkerCluster JS -->
  <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>

  <script>
    // Initialize map
    var map = L.map('map');

    // Add basemap (Carto Light)
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/">OSM</a> &copy; <a href="https://carto.com/">CARTO</a>',
      subdomains: 'abcd',
      maxZoom: 19
    }).addTo(map);

    // Marker cluster group
    var markers = L.markerClusterGroup();

    // Marker style
    var pinkMarker = {
      radius: 8,
      fillColor: "rgba(255,100,120,0.6)",
      color: "rgba(255,100,120,0.85)",
      weight: 2,
      opacity: 1,
      fillOpacity: 0.6
    };

    // All locations
    var locations = [
      [35.050832, 135.764815, "Kyoto Botanical Gardens Kitayama Gate - Entrance Flowers", "https://github.com/bacterialclown/The-Uncanny-Blooms-of-Kyoto/raw/main/Botanical_gardens_northentrance_flowers.png"],
      [35.050910, 135.765411, "Garden of Fine Arts Kyoto - Water Droplets Splash"],
      [35.049380, 135.783392, "Kyoto D-Lab Digital Factory - Entrance Door"],
      [35.0494792385254, 135.78308452924995, "Kyoto D-Lab Biomaterial Factory - Fuzzy Growth"],
      [35.04381756643472, 135.7686946204792, "Takeuchi Building - Letterhead Swab"],
      [35.052176, 135.801972, "Rinkyu-ji - Rain Puddle at Entrance"],
      [35.038513871944744, 135.77297365074668, "Shimogamo Romon Tower Gate Entrance"],
      [35.036475927204755, 135.7724325770189, "Tadasu no Mori Stream"],
      [35.03582639280549, 135.77226858688567, "Sawata Shrine"],
      [35.03440879822148, 135.7722329432176, "Mitsui Shrine (Shimogamo) - Leaf Imprint"],
      [35.03403234762503, 135.7725287059864, "Shimogamo Walkway Entrance - Small Tori Swab"],
      [35.02940619931638, 135.7713508646993, "Kamogawa Delta Stepping Stones - Rock Swab"],
      [35.03031977774956, 135.77185139685884, "Kamogawa Delta Pines - Open lid 1hour"],
      [35.029873611528416, 135.77179838259116, "Kamogawa Delta - Ground rock swab"],
      [35.03008474370446, 135.7717923175234, "Kamogawa Delta - Barbeque Sign"],
      [35.03082574199666, 135.77220722515366, "Kamogawa Delta Tokugawa Bridge - Plant Sample"],
      [35.0285340624543, 135.786316405665, "Yoshida Shrine Kita San-do Entrance - Open- lid hike"],
      [35.02662890165938, 135.7955649281817, "Philosopher's Path I - Bridge Swab"],
      [35.02272676492732, 135.79756549591235, "Honen-in Temple - Rock Swab"],
      [35.020170559003724, 135.79389884417768, "Philosopher's Path II - Direction Sign Swab"],
      [35.01706908201358, 135.77313056524812, "Club METRO - Entrance swab"],
      [35.01391897022208, 135.7808753473747, "ROHM Theatre Kyoto South Hall - Entrance Swab"],
      [35.01256930647346, 135.78280845154796, "Heian Jingu Shrine Grand Tori - Swab"],
      [35.01269574472968, 135.7830425454168, "Kyoto City KYOCERA Museum of Art - Viewing Spot Rail swab"],
      [35.012608238597316, 135.78411289659834, "Kyoto City KYOCERA Museum of Art - Japanese Gardens"],
      [35.03297332882252, 135.77774962752125, "Mototanaka Apartment Building - Doorhandle Swab"],
      [35.0303808491346, 135.7732914373636, "Demachiyanagi Station South Entrance - Right-side Ticket Dispenser Screen Swab"],
      [35.0437230468999, 135.7967396640408, "Hachidai Shrine - Cotton Swab"],
      [35.04396394946672, 135.78732420437797, "Ichijoji Station - Train Barrier Swab"],
      [35.029345539615335, 135.78837013716438, "Shigagoe Michi - Canal Barrier Swab"]
    ];

    // Add markers with optional pop-up images
    var bounds = [];
    locations.forEach(function(loc) {
      var popupContent = "<b>" + loc[2] + "</b>";
      if(loc[3]) {
        popupContent += "<br><img src='" + loc[3] + "' class='popup-img'>";
      }
      var marker = L.circleMarker([loc[0], loc[1]], pinkMarker).bindPopup(popupContent);
      markers.addLayer(marker);
      bounds.push([loc[0], loc[1]]);
    });

    map.addLayer(markers);

    // Fit map to markers
    if (bounds.length) map.fitBounds(bounds, { padding: [20, 20] });
    else map.setView([35.0116, 135.7681], 13);
  </script>
</body>
</html>
